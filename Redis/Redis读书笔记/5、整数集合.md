## 一、简介

整数集合（intset）是集合键的底层实现之一, 当一个集合只包含整数值元素，并且这个集合的元素数量不多时，Redis就会使用整数集合作为集合键的底层实现。

比如：

```
redis> SADD numbers 1 3 5 7 9
(integer) 5
redis> OBJECT ENCODING numbers
"intset"
```
## 二、重点

### 2.1 结构体

```
typedef struct intset {
    // 编码方式
    uint32_t encoding;

    // 集合包含的元素数量
    uint32_t length;
 
    // 保存元素的数组
    int8_t contents[];

} intset;
```

### 2.2 升级

如果我们添加到整数集合中的元素比以前的整数的长度都要长，那么就需要升级，所有的元素都要升级为最长的那个整数的长度，比如原先全是int16\_t的整数，现在突然添加了
一个int64\_t的整数，那么整个intset都要升级为int64\_t。

整数集合不支持降级操作


## 三、总结

整数集合是集合键的底层实现之一。
- 整数集合的底层实现为数组，这个数组以有序、无重复的方式保存集合元素，在有需要时，程序会根据新添加元素的类型，改变这个数组的类型。
- 升级操作为整数集合带来了操作上的灵活性，并且尽可能地节约了内存。
- 整数集合只支持升级操作，不支持降级操作。